"use strict";var gulp=require("gulp"),rename=require("gulp-rename"),sequence=require("gulp-sequence"),concat=require("gulp-concat"),stripComments=require("gulp-strip-comments"),angularTemplateCache=require("gulp-angular-templatecache"),uglifyJS=require("uglify-js"),uglifyComposer=require("gulp-uglify/composer"),jscs=require("gulp-jscs"),sass=require("gulp-sass"),sassLint=require("gulp-sass-lint"),less=require("gulp-less"),lessHint=require("gulp-lesshint"),htmlHint=require("gulp-htmlhint"),cleanCSS=require("gulp-clean-css"),postCSS=require("gulp-postcss"),autoprefixer=require("autoprefixer"),mocha=require("gulp-mocha"),istanbul=require("gulp-istanbul"),nsp=require("gulp-nsp"),pump=require("pump"),mergeStream=require("merge-stream"),through=require("through2"),utilities=require("extra-utilities"),changeCase=require("change-case"),path=require("path"),PluginError=require("plugin-error"),fabricator={};function getContent(buffer){if(utilities.isObject(buffer)&&utilities.isValid(buffer.contents))return buffer.contents.toString();if(buffer instanceof Buffer)return buffer.toString();if("string"==typeof buffer)return buffer;throw new Error("Could not retrieve content.")}function updateContent(buffer,content,encoding){return utilities.isObject(buffer)&&utilities.isValid(buffer.contents)?(buffer.contents=new Buffer(content,encoding),buffer):buffer instanceof Buffer?new Buffer(content,encoding):content}fabricator.setup=function(options){function namespace(value){return utilities.isEmptyString(value)?value:(utilities.isEmptyString(options.namespace)?"":options.namespace+":")+value.trim().replace(/^[:]+/,"")}options=fabricator.formatOptions(options);var tasks={build:[],lint:[],test:[],coverage:[],security:[],watch:[],default:[]};(fabricator.config=options).build.tasks.includes("js")&&(options.build.enabled&&(gulp.task(namespace("build:js"),function(callback){pump([mergeStream(gulp.src(options.js.source),"angular"===options.build.transformation&&options.html.angular.cacheTemplates?gulp.src(options.html.source).pipe(options.build.stripComments.enabled&&options.html.stripComments.enabled?stripComments(options.html.stripComments.options):fabricator.noop()).pipe(fabricator.transformation.trimWhitespace(!0)).pipe(angularTemplateCache({module:changeCase.param(options.name)+".templates",standalone:!0,root:options.html.angular.templateRoot,transformUrl:function(value){return utilities.isEmptyString(value)?value:value.replace(new RegExp("^(.*"+options.html.angular.templateRoot+"([/\\]))","i"),changeCase.param(options.name)+"$2")}})):gulp.src([])).pipe("angular"===options.build.transformation?fabricator.transform({transformation:"function"}):fabricator.noop()).pipe(options.build.bundle?concat((utilities.isEmptyString(options.build.prefix)?"":options.build.prefix)+options.build.fileName+".js"):fabricator.noop()).pipe("module"===options.type?fabricator.transform({transformation:options.build.transformation,name:options.build.exportName}):fabricator.noop()).pipe(options.build.stripComments.enabled&&options.js.stripComments.enabled?stripComments(options.js.stripComments.options):fabricator.noop()).pipe(gulp.dest(options.js.destination)).pipe(rename({extname:".min.js"})),uglifyComposer(uglifyJS,console)({mangle:!1}),gulp.dest(options.js.destination)],callback)}),tasks.build.push(namespace("build:js"))),options.lint.enabled&&options.js.lint.enabled&&(gulp.task(namespace("lint:js"),function(){gulp.src(options.js.source).pipe(jscs({config:options.js.lint.options})).pipe(jscs.reporter())}),tasks.lint.push(namespace("lint:js"))),options.lint.enabled&&options.html.lint.enabled&&(gulp.task(namespace("lint:html"),function(){gulp.src(options.html.source).pipe(htmlHint(options.html.lint.options)).pipe(htmlHint.reporter())}),tasks.lint.push(namespace("lint:html")))),(options.build.tasks.includes("scss")||options.build.tasks.includes("less")||options.build.tasks.includes("css"))&&(options.build.enabled&&(gulp.task(namespace("build:css"),function(callback){mergeStream(gulp.src(options.css.source),options.build.tasks.includes("scss")?gulp.src(options.scss.source).pipe(options.build.stripComments.enabled&&options.scss.stripComments.enabled?stripComments(options.scss.stripComments.options):fabricator.noop()).pipe(sass().on("error",sass.logError)):gulp.src([]),options.build.tasks.includes("less")?gulp.src(options.less.source).pipe(options.build.stripComments.enabled&&options.less.stripComments.enabled?stripComments(options.less.stripComments.options):fabricator.noop()).pipe(less()):gulp.src([])).pipe(rename({prefix:utilities.isEmptyString(options.build.prefix)?"":options.build.prefix})).pipe(options.css.autoprefixer.enabled?postCSS([autoprefixer(options.css.autoprefixer.options)]):fabricator.noop()).pipe(options.build.stripComments.enabled&&options.css.stripComments.enabled?stripComments(options.css.stripComments.options):fabricator.noop()).pipe(gulp.dest(options.css.destination)).pipe(cleanCSS()).pipe(rename({extname:".min.css"})).pipe(gulp.dest(options.css.destination)).on("end",callback)}),tasks.build.push(namespace("build:css"))),options.lint.enabled&&options.scss.lint.enabled&&(gulp.task(namespace("lint:scss"),function(){gulp.src(options.scss.source).pipe(sassLint(options.scss.lint)).pipe(sassLint.format()).pipe(sassLint.failOnError())}),tasks.lint.push(namespace("lint:scss"))),options.lint.enabled&&options.less.lint.enabled&&(gulp.task(namespace("lint:less"),function(){gulp.src(options.less.source).pipe(lessHint(options.less.lint.options)).pipe(lessHint.reporter(options.less.lint.reporter)).pipe(lessHint.failOnError())}),tasks.lint.push(namespace("lint:less")))),options.test.enabled&&(gulp.task(namespace("test:main"),function(callback){gulp.src(options.test.source).pipe(mocha({reporter:options.test.reporter}))}),tasks.test.push(namespace("test:main"))),options.coverage.enabled&&(gulp.task(namespace("coverage:before"),function(){gulp.src(options.test.target).pipe(istanbul({includeUntested:!0})).pipe(istanbul.hookRequire())}),tasks.coverage.push(namespace("coverage:before")),gulp.task(namespace("coverage:main"),function(callback){gulp.src(options.test.source).pipe(mocha()).pipe(istanbul.writeReports())}),tasks.coverage.push(namespace("coverage:main"))),options.security.enabled&&(gulp.task(namespace("security:main"),function(callback){nsp({package:path.join(utilities.isEmptyString(options.base.directory)?"":options.base.directory,"package.json"),stopOnError:!1},callback)}),tasks.security.push(namespace("security:main"))),gulp.task(namespace("watch:main"),function(){options.build.tasks.includes("js")&&(gulp.watch(options.js.source,[namespace("build:js")]),"angular"===options.build.transformation&&options.html.angular.cacheTemplates&&gulp.watch(options.html.source,[namespace("build:js")])),options.build.tasks.includes("scss")&&gulp.watch(options.scss.source,[namespace("build:css")]),options.build.tasks.includes("less")&&gulp.watch(options.less.source,[namespace("build:css")]),options.build.tasks.includes("css")&&gulp.watch(options.css.source,[namespace("build:css")])}),tasks.watch.push(namespace("watch:main")),options.build.watch&&tasks.default.push("watch"),tasks.default.push("build","lint","security"),gulp.task(namespace("build"),utilities.isEmptyArray(tasks.build)?[]:sequence.apply(this,tasks.build)),gulp.task(namespace("lint"),utilities.isEmptyArray(tasks.lint)?[]:sequence.apply(this,tasks.lint)),gulp.task(namespace("test"),utilities.isEmptyArray(tasks.test)?[]:sequence.apply(this,tasks.test)),gulp.task(namespace("coverage"),utilities.isEmptyArray(tasks.coverage)?[]:sequence.apply(this,tasks.coverage)),gulp.task(namespace("security"),utilities.isEmptyArray(tasks.security)?[]:sequence.apply(this,tasks.security)),gulp.task(namespace("watch"),utilities.isEmptyArray(tasks.watch)?[]:sequence.apply(this,tasks.watch)),gulp.task(namespace("default"),utilities.isEmptyArray(tasks.default)?[]:sequence.apply(this,tasks.default))},fabricator.formatOptions=function(options){return utilities.formatValue(options,{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,nonEmpty:!0,required:!0,formatter:function(value,format,options){for(var fileType in utilities.isEmptyString(value.build.fileName)&&(value.build.fileName=changeCase.param(value.name)),utilities.isEmptyString(value.build.exportName)&&(value.build.exportName=changeCase.camel(value.name)),Array.isArray(value.test.target)||(value.test.target=[path.join(value.js.destination,"*.js"),"!"+path.join(value.js.destination,"*.min.js")]),void 0===value.build.prefix&&"angular"===value.build.transformation&&(value.build.prefix="angular-"),["js","html","scss","less","css"]){var config=value[fileType];for(var locationType in["source, destination"]){var baseLocation=value.base[locationType];if(!utilities.isEmptyString(baseLocation)){var location=config[locationType];if(utilities.isNonEmptyString(location))config[locationType]=path.join(baseLocation,location);else if(utilities.isNonEmptyArray()){for(var formattedLocation=[],i=0;i<location.length;i++)formattedLocation.push(path.join(baseLocation,location[i]));config[locationType]=formattedLocation}}}}return value},format:{name:{type:"string",case:"title",trim:!0,nonEmpty:!0,required:!0},type:{type:"string",case:"lower",trim:!0,nonEmpty:!0,default:"module",formatter:function(value,format,options){if("module"!==value&&"website"!==value)throw new Error('Invalid or unsupported module type - expected Module or Website, received: "'+value+'".');return value}},js:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{source:{type:"array",default:["src/**/*.js"],format:{type:"string",trim:!0,nonEmpty:!0}},destination:{type:"string",trim:!0,nonEmpty:!0,default:"dist/"},bundle:{type:"boolean",default:!0},stripComments:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{space:{type:"boolean",default:!1},trim:{type:"boolean",default:!0}}}}},lint:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!1},options:{type:"object",strict:!0,autopopulate:!0,format:{disallowDanglingUnderscores:{type:"boolean",default:!0},disallowEmptyBlocks:{type:"boolean",default:!0},disallowMultipleLineBreaks:{type:"boolean",default:!0},disallowMultipleLineStrings:{type:"boolean",default:!0},disallowMultipleSpaces:{type:"boolean",default:!0},disallowMultipleVarDecl:{type:"boolean",default:!0},disallowNewlineBeforeBlockStatements:{type:"boolean",default:!0},disallowPaddingNewlinesInBlocks:{type:"boolean",default:!0},disallowQuotedKeysInObjects:{type:"boolean",default:!0},disallowSpaceAfterKeywords:{type:"array",default:["if","for","while","switch","catch"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["else","for","while","do","switch","try","catch"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpaceAfterKeywords keyword: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},disallowSpaceAfterObjectKeys:{type:"boolean",default:!0},disallowSpaceAfterPrefixUnaryOperators:{type:"array",default:["++","--","~","!"],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["++","--","+","-","~","!"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpaceAfterPrefixUnaryOperators operator: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},disallowSpaceBeforeBinaryOperators:{type:"array",default:[","],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["=",",","+","-","/","*","==","===","!=","!=="],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpaceBeforeBinaryOperators operator: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},disallowSpaceBeforeComma:{type:"boolean",default:!0},disallowSpaceBeforePostfixUnaryOperators:{type:"array",default:["++","--"],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["++","--"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpaceBeforePostfixUnaryOperators operator: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},disallowSpaceBeforeSemicolon:{type:"boolean",default:!0},disallowSpacesInCallExpression:{type:"boolean",default:!0},disallowSpacesInFunctionDeclaration:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean",default:!0},beforeOpeningCurlyBrace:{type:"boolean"}}},disallowSpacesInFunctionExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean",default:!0},beforeOpeningCurlyBrace:{type:"boolean"}}},disallowSpacesInNamedFunctionExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean",default:!0},beforeOpeningCurlyBrace:{type:"boolean"}}},disallowSpacesInsideBrackets:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{allExcept:{type:"array",default:["[","]","{","}"],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["[","]","{","}"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpacesInsideBrackets allExcept bracket type: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}}}},disallowSpacesInsideParentheses:{type:"boolean",default:!0},disallowSpacesInsideParenthesizedExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{allExcept:{type:"array",default:["(",")"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["(",")","{","}","function"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS disallowSpacesInsideParenthesizedExpression allExcept value: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}}}},disallowTrailingComma:{type:"boolean",default:!0},disallowTrailingWhitespace:{type:"boolean",default:!0},disallowUnusedVariables:{type:"boolean",default:!0},disallowYodaConditions:{type:"boolean",default:!0},requireBlocksOnNewline:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{includeComments:{type:"boolean",default:!0},minLines:{type:"integer",default:1,validator:function(value,format,options){return 0<=value}}}},requireCamelCaseOrUpperCaseIdentifiers:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{ignoreProperties:{type:"boolean",default:!0}}},requireCommaBeforeLineBreak:{type:"boolean",default:!0},requireCurlyBraces:{type:"boolean",default:!0},requireKeywordsOnNewLine:{type:"array",default:["else","catch"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["else","catch"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireKeywordsOnNewLine value: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireLineBreakAfterVariableAssignment:{type:"boolean",default:!0},requireLineFeedAtFileEnd:{type:"boolean",default:!0},requirePaddingNewLinesAfterUseStrict:{type:"boolean",default:!0},requirePaddingNewLinesBeforeExport:{type:"boolean",default:!0},requirePaddingNewlinesBeforeKeywords:{type:"array",default:["do","for","if","try"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["do","for","else","if","try"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requirePaddingNewlinesBeforeKeywords value: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireSemicolons:{type:"boolean",default:!0},requireSpaceAfterBinaryOperators:{type:"array",default:["=",",","+","-","/","*","==","===","!=","!=="],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["=",",","+","-","/","*","==","===","!=","!=="],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireSpaceAfterBinaryOperators operator: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireSpaceAfterComma:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{allExcept:{type:"array",default:["trailing"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["trailing"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireSpaceAfterComma allExcept value: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}}}},requireSpaceAfterKeywords:{type:"array",default:["do","else","try","return","typeof"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["do","else","try","return","typeof"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireSpaceAfterKeywords keyword: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireSpaceAfterLineComment:{type:"boolean",default:!0},requireSpaceBeforeBinaryOperators:{type:"array",default:["=","+","-","/","*","==","===","!=","!=="],format:{type:"string",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["=","+","-","/","*","==","===","!=","!=="],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireSpaceAfterKeywords keyword: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireSpaceBeforeBlockStatements:{type:"integer",default:1,validator:function(value,format,options){return 0<=value}},requireSpaceBeforeKeywords:{type:"array",default:["while"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["else","while","catch"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS requireSpaceBeforeKeywords keyword: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}},requireSpaceBeforeObjectValues:{type:"boolean",default:!0},requireSpaceBetweenArguments:{type:"boolean",default:!0},requireSpacesInAnonymousFunctionExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean"},beforeOpeningCurlyBrace:{type:"boolean",default:!0}}},requireSpacesInConditionalExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{afterTest:{type:"boolean",default:!0},beforeConsequent:{type:"boolean",default:!0},afterConsequent:{type:"boolean",default:!0},beforeAlternate:{type:"boolean",default:!0}}},requireSpacesInFunctionDeclaration:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean"},beforeOpeningCurlyBrace:{type:"boolean",default:!0}}},requireSpacesInFunctionExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean"},beforeOpeningCurlyBrace:{type:"boolean",default:!0}}},requireSpacesInFunction:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean"},beforeOpeningCurlyBrace:{type:"boolean",default:!0}}},requireSpacesInNamedFunctionExpression:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{beforeOpeningRoundBrace:{type:"boolean"},beforeOpeningCurlyBrace:{type:"boolean",default:!0}}},requireSpacesInsideObjectBrackets:{type:"string",case:"camel",trim:!0,nonEmpty:!0,default:"all",validator:function(value,format,options){if("all"!==value&&"allButNested"!==value)throw new Error('Invalid JSCS requireSpacesInsideObjectBrackets value: "'+value+'" - expected all or allButNested.');return!0}},safeContextKeyword:{type:"array",default:["self"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0}},validateIndentation:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{value:{type:"string",trim:!0,nonEmpty:!0,default:"\t"},allExcept:{type:"array",nonEmpty:!0,default:["comments","emptyLines"],format:{type:"string",case:"camel",trim:!0,nonEmpty:!0,validator:function(value,format,options){for(var validValues=["comments","emptyLines"],validValue=!1,i=0;i<validValues.length;i++)if(value===validValues[i]){validValue=!0;break}if(!validValue)throw new Error('Invalid JSCS validateIndentation value: "'+value+'" - expected one of: '+validValues.join(", ")+".");return!0}}}}},validateLineBreaks:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{character:{type:"string",case:"upper",trim:!0,nonEmpty:!0,default:"LF",validator:function(value,format,options){if("CR"!==value&&"LF"!==value&&"CRLF"!==value)throw new Error('Invalid JSCS validateLineBreaks character value: "'+value+'" - expected CR, LF or CRLF.');return!0}},reportOncePerFile:{type:"boolean",default:!0}}},validateNewlineAfterArrayElements:{type:"boolean",default:!0},validateParameterSeparator:{type:"string",trim:!0,nonEmpty:!0,default:", "},validateQuoteMarks:{type:"string",trim:!0,nonEmpty:!0,default:'"',validator:function(value,format,options){if('"'!==value&&"'"!==value)throw new Error('Invalid JSCS validateQuoteMarks value: "'+value+'" - expected " or \'.');return!0}}}}}}}},html:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{source:{type:"array",default:["src/**/*.html"],format:{type:"string",trim:!0,nonEmpty:!0}},angular:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{cacheTemplates:{type:"boolean",default:!0},templateRoot:{type:"string",trim:!0,nonEmpty:!0,default:"src"}}},stripComments:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{space:{type:"boolean",default:!1},trim:{type:"boolean",default:!0}}}}},lint:{type:"object",strict:!0,removeExtra:!0,autopopulate:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{"tagname-lowercase":{type:"boolean",default:!0},"attr-lowercase":{type:"boolean",default:!0},"attr-value-double-quotes":{type:"boolean",default:!0},"attr-no-duplication":{type:"boolean",default:!0},"doctype-first":{type:"boolean",default:!1},"tag-pair":{type:"boolean",default:!0},"spec-char-escape":{type:"boolean",default:!0},"id-unique":{type:"boolean",default:!0},"src-not-empty":{type:"boolean",default:!0},"alt-require":{type:"boolean",default:!0},"id-class-value":{type:"string",case:"lower",trim:!0,nonEmpty:!0,default:"dash",validator:function(value,format,options){if("underline"!==value&&"dash"!==value&&"hump"!==value)throw new Error('Invalid html hint id-class-value option: "'+value+'" - expected underline, dash or hump.');return!0}},"style-disabled":{type:"boolean",default:!0},"inline-style-disabled":{type:"boolean",default:!0},"inline-script-disabled":{type:"boolean",default:!0},"space-tab-mixed-disabled":{type:"boolean",default:!0},"id-class-ad-disabled":{type:"boolean",default:!0},"attr-unsafe-chars":{type:"boolean",default:!0}}}}}}},scss:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{source:{type:"array",default:["scss/**/*.scss","scss/**/*.sass"],format:{type:"string",trim:!0,nonEmpty:!0}},stripComments:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{ignore:{type:"regex",default:/url\([\w\s:\/=\-\+;,]*\)/g},space:{type:"boolean",default:!1},trim:{type:"boolean",default:!0}}}}},lint:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{formatter:{type:"string",case:"lower",trim:!0,nonEmpty:!0,default:"stylish"}}},rules:{type:"object",strict:!0,autopopulate:!0,format:{"attribute-quotes":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"border-zero":{type:"array",nonEmpty:!0,default:[1,{convention:"none"}]},"brace-style":{type:"array",nonEmpty:!0,default:[1,{style:"stroustrup","allow-single-line":!0}]},"class-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},"clean-import-paths":{type:"integer",default:0},"declarations-before-nesting":{type:"integer",default:1},"empty-args":{type:"array",nonEmpty:!0,default:[1,{include:!1}]},"empty-line-between-blocks":{type:"array",nonEmpty:!0,default:[1,{include:!0,"allow-single-line-rulesets":!0}]},"extends-before-declarations":{type:"integer",default:1},"extends-before-mixins":{type:"integer",default:1},"final-newline":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"force-attribute-nesting":{type:"integer",default:0},"force-element-nesting":{type:"integer",default:0},"force-pseudo-nesting":{type:"integer",default:0},"function-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},"hex-length":{type:"array",nonEmpty:!0,default:[1,{style:"long"}]},"hex-notation":{type:"array",nonEmpty:!0,default:[1,{style:"uppercase"}]},"id-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},indentation:{type:"array",nonEmpty:!0,default:[1,{size:"tab"}]},"leading-zero":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"mixin-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},"nesting-depth":{type:"integer",default:0},"no-color-keywords":{type:"integer",default:0},"no-color-literals":{type:"integer",default:0},"no-duplicate-properties":{type:"array",nonEmpty:!0,default:[1,[]]},"no-empty-rulesets":{type:"integer",default:0},"no-important":{type:"integer",default:0},"no-invalid-hex":{type:"integer",default:1},"no-misspelled-properties":{type:"array",nonEmpty:!0,default:[1,{"extra-properties":["border-radius-topleft","border-radius-topright","border-radius-bottomright","border-radius-bottomleft","flex-order","flex-positive","flex-negative","flex-pack","flex-line-pack","flex-align","flex-item-align","flex-preferred-size"]}]},"no-qualifying-elements":{type:"array",nonEmpty:!0,default:[1,{"allow-element-with-attribute":!0,"allow-element-with-class":!0,"allow-element-with-id":!0}]},"no-trailing-whitespace":{type:"integer",default:1},"no-trailing-zero":{type:"integer",default:1},"no-url-domains":{type:"integer",default:1},"no-url-protocols":{type:"array",nonEmpty:!0,default:[1,{"allow-protocol-relative-urls":!1}]},"no-vendor-prefixes":{type:"integer",default:0},"one-declaration-per-line":{type:"integer",default:1},"placeholder-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},"property-sort-order":{type:"integer",default:0},quotes:{type:"array",nonEmpty:!0,default:[1,{style:"double"}]},"single-line-per-selector":{type:"integer",default:1},"space-after-bang":{type:"array",nonEmpty:!0,default:[1,{include:!1}]},"space-after-colon":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"space-after-comma":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"space-around-operator":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"space-before-bang":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"space-before-brace":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"space-before-colon":{type:"array",nonEmpty:!0,default:[1,{include:!1}]},"space-between-parens":{type:"array",nonEmpty:!0,default:[1,{include:!1}]},"trailing-semicolon":{type:"array",nonEmpty:!0,default:[1,{include:!0}]},"url-quotes":{type:"integer",default:1},"variable-name-format":{type:"array",nonEmpty:!0,default:[1,{"allow-leading-underscore":!1,convention:"hyphenatedlowercase"}]},"zero-unit":{type:"array",nonEmpty:!0,default:[0,{include:!0}]}}}}}}},less:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{source:{type:"array",default:["less/**/*.less"],format:{type:"string",trim:!0,nonEmpty:!0}},stripComments:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{ignore:{type:"regex",default:/url\([\w\s:\/=\-\+;,]*\)/g},space:{type:"boolean",default:!1},trim:{type:"boolean",default:!0}}}}},lint:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},reporter:{type:"string",trim:!0,nonEmpty:!0,default:"stylish"},options:{type:"object",strict:!0,autopopulate:!0,format:{maxWarnings:{type:"integer",validator:function(value,format,options){return!Number.isInteger(value)||0<=value}}}}}}}},css:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{source:{type:"array",default:[],format:{type:"string",trim:!0,nonEmpty:!0}},destination:{type:"string",trim:!0,nonEmpty:!0,default:"dist/"},autoprefixer:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,default:{}}}},stripComments:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},options:{type:"object",strict:!0,autopopulate:!0,format:{ignore:{type:"regex",default:/url\([\w\s:\/=\-\+;,]*\)/g},space:{type:"boolean",default:!1},trim:{type:"boolean",default:!0}}}}}}},base:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{directory:{type:"string",trim:!0,nonEmpty:!0,required:!0},source:{type:"string",trim:!0,nonEmpty:!0},destination:{type:"string",trim:!0,nonEmpty:!0}}},build:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},fileName:{type:"string",case:"param",trim:!0,nonEmpty:!0},exportName:{type:"string",case:"camel",trim:!0,nonEmpty:!0},transformation:{type:"string",case:"lower",trim:!0,nonEmpty:!0,default:"node",formatter:function(value,format,options){if(utilities.isEmptyString(value)||"none"===value||"disabled"===value)return null;if("nodejs"===value||"node.js"===value)return"node";if("angularjs"===value)return"angular";if("node"!==value&&"angular"!==value)throw new Error('Invalid or unsupported module transformation - expected Node.js, NodeJS, Node, AngularJS or Angular, received: "'+value+'".');return value}},namespace:{type:"string",case:"lower",trim:!0,nonEmpty:!0,formatter:function(value,format,options){return utilities.isEmptyString(value)?value:value.replace(/[:]+$/,"")}},tasks:{type:"array",default:["js"],format:{type:"string",case:"lower",trim:!0,nonEmpty:!0,formatter:function(value,format,options){if("javascript"===value&&(value="js"),"sass"===value&&(value="scss"),"js"!==value&&"scss"!==value&&"less"!==value&&"css"!==value)throw new Error('Invalid or unsupported task: "'+value+'" - expected javascript, js, scss, sass, less or css.');return value}}},prefix:{type:"string",trim:!0,nonEmpty:!0},stripComments:{type:"boolean",default:!0},watch:{type:"boolean",default:!0}}},lint:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0}}},test:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0},source:{type:"array",default:["test/*.js"],format:{type:"string",trim:!0,nonEmpty:!0}},target:{type:"array",format:{type:"string",trim:!0,nonEmpty:!0}},reporter:{type:"string",trim:!0,nonEmpty:!0,default:"spec"}}},coverage:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0}}},security:{type:"object",strict:!0,autopopulate:!0,removeExtra:!0,format:{enabled:{type:"boolean",default:!0}}}}},{throwErrors:!0,verbose:!0})},fabricator.noop=function(){return through.obj()};var format={transformation:{type:"object",strict:!0,removeExtra:!0,autopopulate:!0,format:{encoding:{type:"string",trim:!0,nonEmpty:!0,default:"utf8"},indentation:{type:"string",trim:!0,nonEmpty:!0,default:"\t"},newLine:{type:"string",trim:!0,nonEmpty:!0,default:"\n"}}},transform:{type:"object",strict:!0,autopopulate:!0,format:{transformation:{type:"string",case:"camel",trim:!0,nullable:!0,validator:function(value,format,options){return!(!utilities.isEmptyString(value)&&"none"!==value)||Object.keys(fabricator.transformation).includes(value)}}}}};fabricator.transformation={},fabricator.transformation.indentText=function(buffer,options){return options=utilities.formatValue(options,utilities.merge(format.transformation,{format:{amount:{type:"integer",default:1,validator:function(value,format,options){return 0<=value}},clearEmptyLines:{type:"boolean",default:!0}}}),{throwErrors:!0}),updateContent(buffer,utilities.indentText(getContent(buffer),options.amount,options.indentation,options.clearEmptyLines),options.encoding)},fabricator.transformation.trimWhitespace=function(buffer,options){return options=utilities.formatValue(options,utilities.merge(format.transformation,{format:{trimNewlines:{type:"boolean",default:!1}}}),{throwErrors:!0}),updateContent(buffer,utilities.trimWhitespace(getContent(buffer),options.trimNewlines),options.encoding)},fabricator.transformation.function=function(buffer,options){return updateContent(buffer,"(function() {"+(options=utilities.formatValue(options,format.transformation,{throwErrors:!0})).newLine+options.newLine+utilities.trimTrailingNewlines(utilities.indentText(getContent(buffer),1,options.indentation))+options.newLine+options.newLine+"})();"+options.newLine,options.encoding)},fabricator.transformation.node=function(buffer,options){return updateContent(buffer,"(function(global, factory) {"+(options=utilities.formatValue(options,utilities.merge(format.transformation,{format:{name:{type:"string",case:"camel",trim:!0,nonEmpty:!0,required:!0}}}),{throwErrors:!0})).newLine+options.indentation+'typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() :'+options.newLine+options.indentation+'typeof define === "function" && define.amd ? define(factory) :'+options.newLine+options.indentation+"(global."+options.name+" = factory());"+options.newLine+"} (this, function() {"+options.newLine+options.newLine+options.indentation+'"use strict";'+options.newLine+options.newLine+utilities.trimTrailingNewlines(utilities.indentText(getContent(buffer),1,options.indentation))+options.newLine+options.newLine+"}));"+options.newLine,options.encoding)},fabricator.transformation.angular=function(buffer,options){return updateContent(buffer,"(function(root, factory) {"+(options=utilities.formatValue(options,format.transformation,{throwErrors:!0})).newLine+options.indentation+'if(typeof define === "function" && define.amd) { define(["angular"], factory); }'+options.newLine+options.indentation+"else { factory(angular); }"+options.newLine+"}(this, function(angular) {"+options.newLine+options.newLine+options.indentation+'"use strict";'+options.newLine+options.newLine+utilities.trimTrailingNewlines(utilities.indentParagraph(getContent(buffer),1,options.indentation))+options.newLine+options.newLine+"}));"+options.newLine,options.encoding)},fabricator.transform=function(options){return options=utilities.formatValue(options,format.transform,{throwErrors:!0}),through.obj(function(file,encoding,callback){if(file.isNull())return callback(null,file);if(file.isStream())return callback(new PluginError("fabricator","Streaming is not supported."));if(utilities.isNonEmptyString(options.transformation)&&utilities.isFunction(fabricator.transformation[options.transformation]))try{fabricator.transformation[options.transformation](file,utilities.merge(options,{encoding:encoding}))}catch(error){return callback(new PluginError("fabricator",error.message))}return callback(null,file)})},module.exports=fabricator;